 <!DOCTYPE html>
 <html lang="zh-Hant">
 <head>
     <meta charset="UTF-8">
     <title>æ™ºæ…§åƒåœ¾æ¡¶ç›£æ§é é¢</title>
     <style>
         body {
             font-family: Arial, sans-serif;
             text-align: center;
             padding: 20px;
         }
         h1 {
             margin-bottom: 40px;
         }
         .section {
             margin-bottom: 30px;
         }
         .status {
             font-size: 24px;
             margin-top: 10px;
         }
     </style>
 </head>
 <body>

     <h1>æ™ºæ…§åƒåœ¾æ¡¶å³æ™‚ç›£æ§</h1>

     <div class="section">
         <h2>COæ¿ƒåº¦åµæ¸¬</h2>
         <div id="coStatus" class="status">è¼‰å…¥ä¸­...</div>
         <div id="coValue" class="status"></div>
     </div>

     <div id="dangerWarning" class="status" style="font-size: 20px; color: red;"></div>


     <div class="section">
         <h2>åƒåœ¾æ¡¶ç‹€æ…‹</h2>
         <div id="tcrtStatus" class="status">è¼‰å…¥ä¸­...</div>
     </div>

	<div class="section">
    	<h2>è“‹å­ç‹€æ…‹</h2>
    	<div id="lidStatus" class="status">è¼‰å…¥ä¸­...</div>
	</div>


     <script>
        function updateData() {
          fetch('/api/co')
            .then(response => response.json())
            .then(data => {
              // === é¡¯ç¤º CO ç‹€æ…‹ï¼ˆåœ–ç¤ºï¼‹é¡è‰²ï¼‰
              const statusEl = document.getElementById('coStatus');
              if (data.status === "ALERT") {
                statusEl.innerHTML = "<span style='color:red;'>âš ï¸ COæ¿ƒåº¦éé«˜ï¼</span>";
              } else {
                statusEl.innerHTML = "<span style='color:green;'>âœ… COæ¿ƒåº¦æ­£å¸¸</span>";
              }
        
              // === æ¯ç§’æ›´æ–° ppm èˆ‡ æ›´æ–°æ™‚é–“ï¼ˆä¸è«–æ˜¯å¦è¶…æ¨™ï¼‰
              const valueEl = document.getElementById('coValue');
              const updateTime = new Date(data.updated_at * 1000);
              const formattedTime = updateTime.toLocaleString('zh-TW');
              valueEl.innerHTML = `
                ç›®å‰æ¿ƒåº¦æ•¸å€¼ï¼š${data.value} ppm<br>
                <span style="font-size:12px; color:gray;">æ›´æ–°æ™‚é–“ï¼š${formattedTime}</span>
              `;
        
              // === å±éšªæç¤º DANGERï¼ˆå¦‚æœå‡ºç¾æ‰é¡¯ç¤ºï¼‰
              const warnEl = document.getElementById('dangerWarning');
              if (data.danger === true) {
                warnEl.innerHTML = "ğŸš¨ğŸš¨ğŸš¨ æŒçºŒè¶…æ¨™è¶…é 60 ç§’ï¼è«‹ç«‹å³æª¢æŸ¥ç’°å¢ƒï¼ğŸš¨ğŸš¨ğŸš¨";
              } else {
                warnEl.innerHTML = ""; // â†âœ… æ¢å¾©æ­£å¸¸å°±æ¸…é™¤è­¦å‘Š
              }
            })
            .catch(error => {
              console.error('Error fetching CO data:', error);
            });
        
          // === è®€åƒåœ¾æ¡¶ TCRT ç‹€æ…‹ ===
          fetch('/api/tcrt')
            .then(response => response.json())
            .then(data => {
              const tcrtEl = document.getElementById('tcrtStatus');

			if (data.status === "INACTIVE") {
				tcrtEl.innerHTML = "<span style='color:gray;'>âš ï¸ æ„Ÿæ¸¬å™¨ç¨‹å¼æœªå•Ÿå‹•</span>";
			} else if (data.status === "FULL") {
				tcrtEl.innerHTML = "<span style='color:red;'>ğŸ›‘ åƒåœ¾æ¡¶å·²æ»¿ï¼</span>";
			} else {
				tcrtEl.innerHTML = "<span style='color:green;'>âœ… åƒåœ¾æ¡¶æœªæ»¿</span>";
			}

            })
            .catch(error => {
              console.error('Error fetching TCRT data:', error);
            });

		// === è®€è“‹å­ç‹€æ…‹ ===
		fetch('/status/lid_status.txt')
		    .then(response => response.text())
		    .then(data => {
		        const [status, ts] = data.trim().split('\n');
		        const lidEl = document.getElementById('lidStatus');
		        if (status === 'open') {
		            lidEl.innerHTML = "<span style='color:blue;'>ğŸ”“ è“‹å­é–‹å•Ÿä¸­</span>";
		        } else {
		            lidEl.innerHTML = "<span style='color:black;'>ğŸ”’ è“‹å­å·²é—œé–‰</span>";
		        }
		    });

        }
        
        setInterval(updateData, 1000);
        updateData();
        </script>
        

 </body>
 </html>


